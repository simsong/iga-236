<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>GPG Password Guesser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="layout">
  <h1>GPG Password Guesser</h1>

  <form class="pure-form pure-form-stacked" id="decryptForm">
    <fieldset>
      <!-- Manual Password Entry -->
      <div class="pure-g" style="margin-bottom: 1rem;">
        <div class="pure-u-1 pure-u-md-3-4">
          <label for="currentPassword">Password:</label>
          <input id="currentPassword" type="text" class="pure-input-1" placeholder="Enter password to test..."/>
        </div>
        <div class="pure-u-1 pure-u-md-1-4" style="display: flex; align-items: flex-end;">
          <button type="button" id="btnDecrypt" class="pure-button pure-button-primary" style="width: 100%;">Decrypt</button>
        </div>
      </div>

      <label for="encryptedMessage">GPG Encrypted Message</label>
      <textarea id="encryptedMessage" rows="10" class="pure-input-1" placeholder="-----BEGIN PGP MESSAGE-----&#10;...&#10;-----END PGP MESSAGE-----"></textarea>

      <form id="s2kForm" class="pure-form pure-form-stacked s2k-form" style="display: none;">
        <fieldset>
          <legend>S2K Parameters</legend>
          <div class="s2k-fields">
            <div>
              <label for="s2kCipher">Cipher:</label>
              <input id="s2kCipher" type="text" class="pure-input-1" readonly/>
            </div>
            <div>
              <label for="s2kAlgorithm">S2K Algorithm:</label>
              <input id="s2kAlgorithm" type="text" class="pure-input-1" readonly/>
            </div>
            <div>
              <label for="s2kHash">Hash Algorithm:</label>
              <input id="s2kHash" type="text" class="pure-input-1" readonly/>
            </div>
            <div>
              <label for="s2kSalt">Salt:</label>
              <input id="s2kSalt" type="text" class="pure-input-1" readonly/>
            </div>
            <div>
              <label for="s2kIterations">Iteration Count:</label>
              <input id="s2kIterations" type="text" class="pure-input-1" readonly/>
            </div>
          </div>
        </fieldset>
      </form>

      <label for="decryptedMessage">Decrypted Message</label>
      <textarea id="decryptedMessage" rows="10" class="pure-input-1" readonly placeholder="Decrypted message will appear here..."></textarea>
      <div id="status-display" class="pure-input-1" ></div>

      <hr style="margin: 2rem 0;"/>

      <h2 style="margin-top: 0;">Automated Guesser</h2>

      <!-- Character Set Options - Single Line -->
      <div class="checkbox-row">
        <label for="chkLowercase" class="pure-checkbox inline-checkbox">
          <input type="checkbox" id="chkLowercase" checked> lowercase letters
        </label>
        <label for="chkUppercase" class="pure-checkbox inline-checkbox">
          <input type="checkbox" id="chkUppercase" checked> uppercase letters
        </label>
        <label for="chkSymbols" class="pure-checkbox inline-checkbox">
          <input type="checkbox" id="chkSymbols"> symbols
        </label>
        <label for="chkDigits" class="pure-checkbox inline-checkbox">
          <input type="checkbox" id="chkDigits" checked> digits
        </label>
        <label for="passwordLen" style="margin-left: 1rem;">Password Length:</label>
        <select id="passwordLen" style="margin-left: 0.5rem;">
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5" selected>5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
        </select>
      </div>

      <div id="errorMessage" class="error-message"></div>

      <!-- Two-column layout for stats -->
      <div class="stats-grid">
        <div id="possibleChars-container">
          <label for="possibleChars">Possible Characters in Password:</label>
          <input id="possibleChars" type="text" class="pure-input-1" readonly/>
        </div>
        <div>
          <label for="totalPossible">Total Possible Passwords:</label>
          <input id="totalPossible" type="text" class="pure-input-1" readonly/>
        </div>
        <div>
          <label for="guessesPerSec">Guesses per Second:</label>
          <input id="guessesPerSec" type="text" class="pure-input-1" readonly value="0"/>
        </div>
        <div>
          <label for="elapsedTime">Elapsed Time:</label>
          <input id="elapsedTime" type="text" class="pure-input-1" readonly value="00:00:00"/>
        </div>
        <div style="grid-column: 1 / -1;">
          <label for="estTime">Estimated Time to Try All Passwords:</label>
          <input id="estTime" type="text" class="pure-input-1" readonly value="00:00:00"/>
        </div>
      </div>

      <div class="button-row">
        <button type="button" id="btnStart" class="pure-button pure-button-primary">Start</button>
        <button type="button" id="btnStop" class="pure-button" disabled>Stop</button>
        <button type="button" id="btnReset" class="pure-button">Reset</button>
      </div>

    </fieldset>
  </form>
</div>

<script type="module" src="./main.ts"></script>
</body>
</html>
